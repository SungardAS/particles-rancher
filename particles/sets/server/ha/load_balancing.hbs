{{
  resource "m:core" "spec"
  type="AWS::ElasticLoadBalancingV2::LoadBalancer"
  logicalId="LoadBalancer"
}}

{{resource "server/ha/target_group" logicalId="LoadBalancerTargetGroup"}}

{{#resource "m:core" "base" logicalId="LoadBalancerListener"}}
  "Type" : "AWS::ElasticLoadBalancingV2::Listener",
  "Properties" : {
    "DefaultActions": [
      {
        "TargetGroupArn": {{ref "LoadBalancerTargetGroup"}},
        "Type": "forward"
      }
    ],
    "LoadBalancerArn": {{ref "LoadBalancer"}},
    "Port": 80,
    "Protocol": "HTTP"
  }
{{/resource}}
