---
frontload:
  amis:
    loader: rancheros
---
{{#layout}}

  {{set "host/parameters_rancheros"}}
  {{set "host/parameters_scaling_group"}}

  {{#with amis}}
    {{mapping "rancheros_versions" logicalId="RancherVersionMap"}}
  {{/with}}

  {{
    set "host/resources_scaling_group"
    cattleHostLabels=(ref "CattleHostLabels")
    ImageId=(fnFindInMap "RancherVersionMap" (ref "OsVersion") "ami")
    SignalCount=(ref "DesiredCapacity")
    UserData=(
      partial "userdata/rancheros"
      dockerVersion=(fnFindInMap "RancherVersionMap" (ref "OsVersion") "dockerVersion")
      resizeDevCondition="Is050Condition"
      resizeServiceCondition="Is050Condition"
      metadataResource="LaunchConfiguration"
      notifyResource="AutoScaleGroup"
    )
  }}

{{/layout}}

