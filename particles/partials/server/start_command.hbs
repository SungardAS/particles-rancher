---
rancherServerImage: rancher/server:stable
hostPort: 8080
clusterPort: 9345
dockerCmd: docker
---
{ "Fn::Join" : ["", [
  {{cValue dockerCmd}}," run -d ",
  "  --restart=unless-stopped",
  "  -p ", {{cValue hostPort}}, ":8080",
  "  -p ", {{cValue clusterPort}}, ":9345",
  "  -e 'AWS_REGION=", {"Ref": "AWS::Region"}, "'",
  {{#if cattleHostApiProxyMode}}" -e CATTLE_HOST_API_PROXY_MODE=", {{cValue cattleHostApiProxyMode}},{{/if}}
  {{#if defaultCattleMachineExecute}}" -e DEFAULT_CATTLE_MACHINE_EXECUTE=", {{cValue defaultCattleMachineExecute}},{{/if}}
  {{#if cattleZookeeperConnectionString}}" -e CATTLE_ZOOKEEPER_CONNECTION_STRING=", {{cValue cattleZookeeperConnectionString}},{{/if}}
  {{#if cattleHostApiProxyHost}}" -e CATTLE_HOST_API_PROXY_HOST=", {{cValue cattleHostApiProxyHost}},{{/if}}
  {{#if cattleDbCattleMysqlName}}" -e CATTLE_DB_CATTLE_MYSQL_NAME=", {{cValue cattleDbCattleMysqlName}},{{/if}}
  {{#if cattleDbCattleUsername}}" -e CATTLE_DB_CATTLE_USERNAME=", {{cValue cattleDbCattleUsername}},{{/if}}
  {{#if cattleDbCattlePassword}}" -e CATTLE_DB_CATTLE_PASSWORD=", {{cValue cattleDbCattlePassword}},{{/if}}
  {{#if cattleDbCattleMysqlHost}}" -e CATTLE_DB_CATTLE_MYSQL_HOST=", {{cValue cattleDbCattleMysqlHost}},{{/if}}
  {{#if cattleDbCattleMysqlPort}}" -e CATTLE_DB_CATTLE_MYSQL_PORT=", {{cValue cattleDbCattleMysqlPort}},{{/if}}
  {{#if cattleRedisHosts}}" -e CATTLE_REDIS_HOSTS=", {{cValue cattleRedisHosts}},{{/if}}
  {{#if cattleRedisPort}}" -e CATTLE_REDIS_PORT=", {{cValue cattleRedisPort}},{{/if}}
  "  ", {{cValue rancherServerImage}},
  {{#if cattleClusterAdvertiseAddress}}" --advertise-address {{cattleClusterAdvertiseAddress}}"{{else}}""{{/if}}
]]}
